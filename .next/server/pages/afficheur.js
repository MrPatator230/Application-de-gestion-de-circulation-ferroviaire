(()=>{var e={};e.id=85,e.ids=[85,220,636],e.modules={237:(e,t)=>{"use strict";Object.defineProperty(t,"A",{enumerable:!0,get:function(){return r}});var r=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},361:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},468:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n,l:()=>i});var s=r(8732),a=r(2015);let i=(0,a.createContext)(),n=({children:e})=>{let[t,r]=(0,a.useState)("Ma Soci\xe9t\xe9 Ferroviaire"),[n,l]=(0,a.useState)("Le transport ferroviaire simplifi\xe9"),[o,d]=(0,a.useState)("Description de la soci\xe9t\xe9 ferroviaire..."),[c,u]=(0,a.useState)("#007bff"),[m,h]=(0,a.useState)("#6c757d"),[p,x]=(0,a.useState)("Train Schedule Management");return(0,a.useEffect)(()=>{!async function(){try{let e=await fetch("/api/settings");if(e.ok){let t=await e.json();r(t.companyName||"Ma Soci\xe9t\xe9 Ferroviaire"),l(t.companySlogan||"Le transport ferroviaire simplifi\xe9"),d(t.companyDescription||"Description de la soci\xe9t\xe9 ferroviaire..."),u(t.primaryColor||"#007bff"),h(t.secondaryColor||"#6c757d"),x(t.appName||"Train Schedule Management")}}catch(e){console.error("Failed to fetch settings:",e)}}()},[]),(0,s.jsx)(i.Provider,{value:{companyName:t,setCompanyName:r,companySlogan:n,setCompanySlogan:l,companyDescription:o,setCompanyDescription:d,primaryColor:c,setPrimaryColor:u,secondaryColor:m,setSecondaryColor:h,appName:p,setAppName:x},children:e})}},1413:(e,t)=>{"use strict";Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},2015:e=>{"use strict";e.exports=require("react")},2326:e=>{"use strict";e.exports=require("react-dom")},2768:()=>{},3673:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AuthContext:()=>u,default:()=>h});var s=r(8732);let a=require("styled-jsx/style");var i=r.n(a);r(5378),r(2768);var n=r(2015),l=r(4233),o=r(9788),d=r.n(o),c=r(468);let u=(0,n.createContext)();function m({children:e}){let{primaryColor:t,secondaryColor:r,appName:a}=(0,n.useContext)(c.l);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i(),{id:"f1209dfa6dead71",dynamic:[t,r],children:`:root{--bs-primary:${t};--bs-secondary:${r}}`}),e]})}function h({Component:e,pageProps:t}){let[r,a]=(0,n.useState)(!1),[i,o]=(0,n.useState)(null),h=(0,l.useRouter)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(d(),{children:[(0,s.jsx)("link",{href:"https://cdn.jsdelivr.net/npm/startbootstrap-sb-admin-2@4.1.4/css/sb-admin-2.min.css",rel:"stylesheet"}),(0,s.jsx)("link",{href:"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css",rel:"stylesheet"})]}),(0,s.jsx)(u.Provider,{value:{isAuthenticated:r,role:i,login:(e,t)=>"admin"===e&&"admin"===t?(localStorage.setItem("authToken","dummy-token"),localStorage.setItem("userRole","admin"),localStorage.setItem("username",e),a(!0),o("admin"),h.push("/admin"),!0):!!JSON.parse(localStorage.getItem("users")||"[]").find(r=>r.username===e&&r.password===t)&&(localStorage.setItem("authToken","dummy-token"),localStorage.setItem("userRole","client"),localStorage.setItem("username",e),a(!0),o("client"),h.push("/client"),!0),logout:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("username"),a(!1),o(null),h.push("/login")},register:(e,t)=>{let r=JSON.parse(localStorage.getItem("users")||"[]");return!r.find(t=>t.username===e)&&(r.push({username:e,password:t}),localStorage.setItem("users",JSON.stringify(r)),localStorage.setItem("authToken","dummy-token"),localStorage.setItem("userRole","client"),localStorage.setItem("username",e),a(!0),o("client"),h.push("/client"),!0)}},children:(0,s.jsx)(c.Z,{children:(0,s.jsx)(m,{children:(0,s.jsx)(e,{...t})})})})]})}},3873:e=>{"use strict";e.exports=require("path")},4075:e=>{"use strict";e.exports=require("zlib")},7910:e=>{"use strict";e.exports=require("stream")},8732:e=>{"use strict";e.exports=require("react/jsx-runtime")},9021:e=>{"use strict";e.exports=require("fs")},9154:(e,t,r)=>{"use strict";r.r(t),r.d(t,{config:()=>g,default:()=>p,getServerSideProps:()=>f,getStaticPaths:()=>S,getStaticProps:()=>x,reportWebVitals:()=>j,routeModule:()=>N,unstable_getServerProps:()=>P,unstable_getServerSideProps:()=>T,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>b,unstable_getStaticProps:()=>v});var s={};r.r(s),r.d(s,{default:()=>h});var a=r(3885),i=r(237),n=r(1413),l=r(9616),o=r.n(l),d=r(3673),c=r(8732),u=r(2015);function m(e){if(!e)return null;let[t,r]=e.split(":").map(Number);return 60*t+r}function h(){let[e,t]=(0,u.useState)([]),[r,s]=(0,u.useState)(""),[a,i]=(0,u.useState)([]),[n,l]=(0,u.useState)({}),[o,d]=(0,u.useState)(new Date().toISOString().split("T")[0]),h=(e,t)=>{if(e.departureStation===t)return{arrivalTime:"",departureTime:e.departureTime};if(e.arrivalStation===t)return{arrivalTime:e.arrivalTime,departureTime:""};if(e.servedStations){let r=e.servedStations.find(e=>e.name===t);if(r)return{arrivalTime:r.arrivalTime||"",departureTime:r.departureTime||""}}return{arrivalTime:"",departureTime:""}},p=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][new Date().getDay()],x=function(){let e=new Date;return 60*e.getHours()+e.getMinutes()}(),S=a.filter(e=>!!e.joursCirculation&&!!e.joursCirculation.includes(p)&&!!(e.departureStation===r||e.arrivalStation===r||e.servedStations&&e.servedStations.some(e=>e.name===r))),f=[],g=[];S.forEach(e=>{let t=h(e,r);if(t.arrivalTime){let r=m(t.arrivalTime);null!==r&&r>=x&&f.push({schedule:e,time:t.arrivalTime})}if(t.departureTime){let r=m(t.departureTime);null!==r&&r>=x&&g.push({schedule:e,time:t.departureTime})}}),f.sort((e,t)=>e.time.localeCompare(t.time)),g.sort((e,t)=>e.time.localeCompare(t.time));let j=e=>{let t=m(e);return null!==t&&x>=t-30},v=(e,t)=>e.stopStatus&&e.stopStatus[t]?e.stopStatus[t]:{status:e.status||"on_time",delayMinutes:e.delayMinutes||0};return(0,c.jsxs)("div",{style:{backgroundColor:"#cce7ff",minHeight:"100vh",padding:"1rem"},children:[(0,c.jsx)("h1",{className:"text-center mb-4",children:"Afficheur SNCF - Arriv\xe9es et D\xe9parts"}),(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsx)("label",{htmlFor:"stationSelect",className:"form-label fw-semibold",children:"S\xe9lectionnez une gare"}),(0,c.jsxs)("select",{id:"stationSelect",className:"form-select form-select-lg",value:r,onChange:e=>s(e.target.value),children:[(0,c.jsx)("option",{value:"",children:"-- Choisir une gare --"}),e.map(e=>(0,c.jsx)("option",{value:e.name,children:e.name},e.name))]})]}),r&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"row",children:[(0,c.jsxs)("div",{className:"col-md-6",style:{borderRight:"2px solid #007bff",paddingRight:"1rem"},children:[(0,c.jsxs)("h2",{className:"text-center mb-3",style:{color:"green"},children:["Arriv\xe9es ",(0,c.jsx)("span",{style:{fontSize:"1.5rem"},children:"\uD83E\uDC46"})]}),0===f.length?(0,c.jsx)("p",{className:"text-center text-muted",children:"Aucune arriv\xe9e trouv\xe9e pour cette gare."}):(0,c.jsx)("div",{className:"table-responsive",children:(0,c.jsxs)("table",{className:"table table-striped table-bordered text-center align-middle",children:[(0,c.jsx)("thead",{className:"table-dark",children:(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{children:"Train"}),(0,c.jsx)("th",{children:"Provenance"}),(0,c.jsx)("th",{children:"Heure d'arriv\xe9e"}),(0,c.jsx)("th",{children:"Voie"}),(0,c.jsx)("th",{children:"Statut"})]})}),(0,c.jsx)("tbody",{children:f.map(({schedule:e,time:t})=>{let s=j(t)&&n[e.id]?.[r]?n[e.id][r]:"-",a=v(e,r),i="on_time"===a.status?"\xc0 l'heure":"delayed"===a.status?`En retard (${a.delayMinutes} min)`:"Supprim\xe9";return(0,c.jsxs)("tr",{className:"fs-5 fw-bold",children:[(0,c.jsx)("td",{children:e.trainNumber}),(0,c.jsx)("td",{children:e.departureStation}),(0,c.jsx)("td",{children:t}),(0,c.jsx)("td",{children:s}),(0,c.jsx)("td",{children:i})]},e.id)})})]})})]}),(0,c.jsxs)("div",{className:"col-md-6",style:{paddingLeft:"1rem"},children:[(0,c.jsxs)("h2",{className:"text-center mb-3",style:{color:"blue"},children:["D\xe9parts ",(0,c.jsx)("span",{style:{fontSize:"1.5rem"},children:"\uD83E\uDC46"})]}),0===g.length?(0,c.jsx)("p",{className:"text-center text-muted",children:"Aucun d\xe9part trouv\xe9 pour cette gare."}):(0,c.jsx)("div",{className:"table-responsive",children:(0,c.jsxs)("table",{className:"table table-striped table-bordered text-center align-middle",children:[(0,c.jsx)("thead",{className:"table-dark",children:(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{children:"Train"}),(0,c.jsx)("th",{children:"Destination"}),(0,c.jsx)("th",{children:"Heure de d\xe9part"}),(0,c.jsx)("th",{children:"Voie"}),(0,c.jsx)("th",{children:"Statut"})]})}),(0,c.jsx)("tbody",{children:g.map(({schedule:e,time:t})=>{let s=j(t)&&n[e.id]?.[r]?n[e.id][r]:"-",a=v(e,r),i="on_time"===a.status?"\xc0 l'heure":"delayed"===a.status?`En retard (${a.delayMinutes} min)`:"Supprim\xe9";return(0,c.jsxs)("tr",{className:"fs-5 fw-bold",children:[(0,c.jsx)("td",{children:e.trainNumber}),(0,c.jsx)("td",{children:e.arrivalStation}),(0,c.jsx)("td",{children:t}),(0,c.jsx)("td",{children:s}),(0,c.jsx)("td",{children:i})]},e.id)})})]})})]})]}),0===f.length&&0===g.length&&(0,c.jsx)("p",{className:"text-center mt-4 fst-italic",children:"Les prochains d\xe9parts auront lieu demain"})]})]})}let p=(0,n.M)(s,"default"),x=(0,n.M)(s,"getStaticProps"),S=(0,n.M)(s,"getStaticPaths"),f=(0,n.M)(s,"getServerSideProps"),g=(0,n.M)(s,"config"),j=(0,n.M)(s,"reportWebVitals"),v=(0,n.M)(s,"unstable_getStaticProps"),b=(0,n.M)(s,"unstable_getStaticPaths"),y=(0,n.M)(s,"unstable_getStaticParams"),P=(0,n.M)(s,"unstable_getServerProps"),T=(0,n.M)(s,"unstable_getServerSideProps"),N=new a.PagesRouteModule({definition:{kind:i.A.PAGES,page:"/afficheur",pathname:"/afficheur",bundlePath:"",filename:""},components:{App:d.default,Document:o()},userland:s})}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[89,466,616],()=>r(9154));module.exports=s})();