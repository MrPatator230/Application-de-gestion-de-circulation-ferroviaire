(()=>{var e={};e.id=691,e.ids=[220,636,691],e.modules={361:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},468:(e,a,s)=>{"use strict";s.d(a,{Z:()=>l,l:()=>r});var t=s(8732),i=s(2015);let r=(0,i.createContext)(),l=({children:e})=>{let[a,s]=(0,i.useState)("Ma Soci\xe9t\xe9 Ferroviaire"),[l,n]=(0,i.useState)("Le transport ferroviaire simplifi\xe9"),[c,o]=(0,i.useState)("Description de la soci\xe9t\xe9 ferroviaire..."),[m,d]=(0,i.useState)("#007bff"),[u,h]=(0,i.useState)("#6c757d"),[x,f]=(0,i.useState)("Train Schedule Management");return(0,i.useEffect)(()=>{!async function(){try{let e=await fetch("/api/settings");if(e.ok){let a=await e.json();s(a.companyName||"Ma Soci\xe9t\xe9 Ferroviaire"),n(a.companySlogan||"Le transport ferroviaire simplifi\xe9"),o(a.companyDescription||"Description de la soci\xe9t\xe9 ferroviaire..."),d(a.primaryColor||"#007bff"),h(a.secondaryColor||"#6c757d"),f(a.appName||"Train Schedule Management")}}catch(e){console.error("Failed to fetch settings:",e)}}()},[]),(0,t.jsx)(r.Provider,{value:{companyName:a,setCompanyName:s,companySlogan:l,setCompanySlogan:n,companyDescription:c,setCompanyDescription:o,primaryColor:m,setPrimaryColor:d,secondaryColor:u,setSecondaryColor:h,appName:x,setAppName:f},children:e})}},2015:e=>{"use strict";e.exports=require("react")},2326:e=>{"use strict";e.exports=require("react-dom")},2768:()=>{},3673:(e,a,s)=>{"use strict";s.r(a),s.d(a,{AuthContext:()=>d,default:()=>h});var t=s(8732);let i=require("styled-jsx/style");var r=s.n(i);s(5378),s(2768);var l=s(2015),n=s(4233),c=s(9788),o=s.n(c),m=s(468);let d=(0,l.createContext)();function u({children:e}){let{primaryColor:a,secondaryColor:s,appName:i}=(0,l.useContext)(m.l);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r(),{id:"f1209dfa6dead71",dynamic:[a,s],children:`:root{--bs-primary:${a};--bs-secondary:${s}}`}),e]})}function h({Component:e,pageProps:a}){let[s,i]=(0,l.useState)(!1),[r,c]=(0,l.useState)(null),h=(0,n.useRouter)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o(),{children:[(0,t.jsx)("link",{href:"https://cdn.jsdelivr.net/npm/startbootstrap-sb-admin-2@4.1.4/css/sb-admin-2.min.css",rel:"stylesheet"}),(0,t.jsx)("link",{href:"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css",rel:"stylesheet"})]}),(0,t.jsx)(d.Provider,{value:{isAuthenticated:s,role:r,login:(e,a)=>"admin"===e&&"admin"===a?(localStorage.setItem("authToken","dummy-token"),localStorage.setItem("userRole","admin"),localStorage.setItem("username",e),i(!0),c("admin"),h.push("/admin"),!0):!!JSON.parse(localStorage.getItem("users")||"[]").find(s=>s.username===e&&s.password===a)&&(localStorage.setItem("authToken","dummy-token"),localStorage.setItem("userRole","client"),localStorage.setItem("username",e),i(!0),c("client"),h.push("/client"),!0),logout:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("username"),i(!1),c(null),h.push("/login")},register:(e,a)=>{let s=JSON.parse(localStorage.getItem("users")||"[]");return!s.find(a=>a.username===e)&&(s.push({username:e,password:a}),localStorage.setItem("users",JSON.stringify(s)),localStorage.setItem("authToken","dummy-token"),localStorage.setItem("userRole","client"),localStorage.setItem("username",e),i(!0),c("client"),h.push("/client"),!0)}},children:(0,t.jsx)(m.Z,{children:(0,t.jsx)(u,{children:(0,t.jsx)(e,{...a})})})})]})}},3873:e=>{"use strict";e.exports=require("path")},4075:e=>{"use strict";e.exports=require("zlib")},5624:(e,a,s)=>{"use strict";s.d(a,{A:()=>m});var t=s(8732),i=s(9918),r=s.n(i),l=s(4233),n=s(2015),c=s(3673),o=s(468);function m(){let e=(0,l.useRouter)().pathname,{logout:a}=(0,n.useContext)(c.AuthContext),{companyName:s}=(0,n.useContext)(o.l);return(0,t.jsxs)("ul",{className:"navbar-nav bg-gradient-primary sidebar sidebar-dark accordion d-flex flex-column",id:"accordionSidebar",style:{height:"100vh",position:"sticky",top:0},children:[(0,t.jsxs)(r(),{href:"/admin",className:"sidebar-brand d-flex align-items-center justify-content-center",children:[(0,t.jsx)("div",{className:"sidebar-brand-icon",children:(0,t.jsx)("i",{className:"fas fa-train"})}),(0,t.jsx)("div",{className:"sidebar-brand-text mx-3",children:s})]}),(0,t.jsx)("hr",{className:"sidebar-divider my-0"}),(0,t.jsx)("li",{className:`nav-item ${"/admin"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/admin",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-tachometer-alt"}),(0,t.jsx)("span",{children:"Dashboard"})]})}),(0,t.jsx)("li",{className:`nav-item ${"/admin/entreprise"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/admin/entreprise",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-building"}),(0,t.jsx)("span",{children:"Entreprise"})]})}),(0,t.jsx)("li",{className:`nav-item ${"/stations"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/stations",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-train"}),(0,t.jsx)("span",{children:"Gestion de gares"})]})}),(0,t.jsx)("li",{className:`nav-item ${"/admin/horaires"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/admin/horaires",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-clock"}),(0,t.jsx)("span",{children:"Horaires"})]})}),(0,t.jsx)("li",{className:`nav-item ${"/admin/materiels-roulants"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/admin/materiels-roulants",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-cogs"}),(0,t.jsx)("span",{children:"Mat\xe9riels Roulants"})]})}),(0,t.jsx)("li",{className:`nav-item ${"/admin/info-trafics"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/admin/info-trafics",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-info-circle"}),(0,t.jsx)("span",{children:"Infos Trafic"})]})}),(0,t.jsx)("li",{className:`nav-item ${"/admin/attribution-voie"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/admin/attribution-voie",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-map-signs"}),(0,t.jsx)("span",{children:"Attribution Voie"})]})}),(0,t.jsx)("li",{className:`nav-item ${"/admin/type-horaires"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/admin/type-horaires",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-clock"}),(0,t.jsx)("span",{children:"Type Horaires"})]})}),(0,t.jsx)("li",{className:`nav-item ${"/admin/sauvegarde"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/admin/sauvegarde",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-save"}),(0,t.jsx)("span",{children:"Sauvegarde"})]})}),(0,t.jsx)("li",{className:`nav-item ${"/admin/update"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/admin/update",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-sync-alt"}),(0,t.jsx)("span",{children:"Mise \xe0 jour"})]})}),(0,t.jsx)("li",{className:`nav-item ${"/admin/actualites"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/admin/actualites",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-newspaper"}),(0,t.jsx)("span",{children:"Actualit\xe9s"})]})}),(0,t.jsx)("hr",{className:"sidebar-divider mt-auto"}),(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsxs)("a",{href:"#",onClick:e=>{e.preventDefault(),a()},className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-sign-out-alt"}),(0,t.jsx)("span",{children:"D\xe9connexion"})]})})]})}},7910:e=>{"use strict";e.exports=require("stream")},8732:e=>{"use strict";e.exports=require("react/jsx-runtime")},9021:e=>{"use strict";e.exports=require("fs")},9597:(e,a,s)=>{"use strict";s.r(a),s.d(a,{config:()=>v,default:()=>f,getServerSideProps:()=>j,getStaticPaths:()=>g,getStaticProps:()=>p,reportWebVitals:()=>N,routeModule:()=>C,unstable_getServerProps:()=>k,unstable_getServerSideProps:()=>w,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>S,unstable_getStaticProps:()=>b});var t={};s.r(t),s.d(t,{default:()=>x});var i=s(3885),r=s(237),l=s(1413),n=s(9616),c=s.n(n),o=s(3673),m=s(8732),d=s(2015),u=s(4233),h=s(5624);function x(){let{role:e,isAuthenticated:a}=(0,d.useContext)(o.AuthContext);(0,u.useRouter)();let[s,t]=(0,d.useState)([]),[i,r]=(0,d.useState)(""),[l,n]=(0,d.useState)(""),[c,x]=(0,d.useState)([]),[f,p]=(0,d.useState)([]),[g,j]=(0,d.useState)(null),[v,N]=(0,d.useState)(null),[b,S]=(0,d.useState)(""),y=e=>{t(e),localStorage.setItem("materielsRegions",JSON.stringify(e))},k=e=>{x(e),localStorage.setItem("materielsRoulants",JSON.stringify(e))},w=e=>{confirm(`\xcates-vous s\xfbr de vouloir supprimer la r\xe9gion "${e}" et tous ses mat\xe9riels roulants ?`)&&(y(s.filter(a=>a!==e)),k(c.filter(a=>a.region!==e)),i===e&&r(""))},C=e=>{confirm("\xcates-vous s\xfbr de vouloir supprimer ce mat\xe9riel roulant ?")&&(k(c.filter(a=>a.id!==e)),g===e&&(j(null),N(null),S("")))},M=e=>{j(e.id),r(e.region),S(e.imageName),N(null)};return(0,m.jsxs)("div",{id:"wrapper",style:{display:"flex",minHeight:"100vh"},children:[(0,m.jsx)(h.A,{}),(0,m.jsx)("div",{id:"content-wrapper",className:"d-flex flex-column flex-grow-1",children:(0,m.jsxs)("div",{id:"content",className:"container mt-4 flex-grow-1 d-flex",children:[(0,m.jsxs)("div",{style:{width:"250px",marginRight:"1rem"},children:[(0,m.jsx)("h2",{children:"R\xe9gions"}),(0,m.jsx)("ul",{className:"list-group mb-3",children:s.map(e=>(0,m.jsxs)("li",{className:`list-group-item d-flex justify-content-between align-items-center ${i===e?"active":""}`,style:{cursor:"pointer"},onClick:()=>r(e),children:[e,(0,m.jsx)("button",{className:"btn btn-sm btn-danger",onClick:a=>{a.stopPropagation(),w(e)},children:"Supprimer"})]},e))}),(0,m.jsxs)("div",{className:"input-group",children:[(0,m.jsx)("input",{type:"text",className:"form-control",placeholder:"Nouvelle r\xe9gion",value:l,onChange:e=>n(e.target.value)}),(0,m.jsx)("button",{className:"btn btn-primary",onClick:()=>{let e=l.trim();return e?s.includes(e)?void alert("Cette r\xe9gion existe d\xe9j\xe0."):void(y([...s,e]),n(""),r(e)):void alert("Le nom de la r\xe9gion ne peut pas \xeatre vide.")},children:"Ajouter"})]})]}),(0,m.jsxs)("div",{className:"flex-grow-1",children:[(0,m.jsxs)("h1",{children:["Gestion des Mat\xe9riels Roulants ",i&&`- R\xe9gion: ${i}`]}),i?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!i)return void alert("Veuillez s\xe9lectionner une r\xe9gion.");if(!b.trim()||null===g&&!v)return void alert("Veuillez saisir un nom pour le fichier et choisir une image si vous ajoutez un nouveau mat\xe9riel.");let a=a=>{null!==g?k(c.map(e=>e.id===g?{...e,region:i,imageName:b.trim(),imageData:a||e.imageData}:e)):k([...c,{id:Date.now(),region:i,imageData:a,imageName:b.trim()}]),N(null),S(""),j(null),e.target.reset()};if(v){let e=new FileReader;e.onloadend=()=>{a(e.result)},e.readAsDataURL(v)}else a(null)},className:"mb-4",children:[(0,m.jsxs)("div",{className:"mb-3",children:[(0,m.jsx)("label",{htmlFor:"imageName",className:"form-label",children:"Nom du fichier"}),(0,m.jsx)("input",{type:"text",id:"imageName",className:"form-control",value:b,onChange:e=>S(e.target.value),required:!0})]}),(0,m.jsxs)("div",{className:"mb-3",children:[(0,m.jsxs)("label",{htmlFor:"imageFile",className:"form-label",children:["Image du Mat\xe9riel Roulant ",null!==g?"(laisser vide pour garder l'image actuelle)":""]}),(0,m.jsx)("input",{type:"file",id:"imageFile",className:"form-control",accept:"image/*",onChange:e=>N(e.target.files[0]),...null===g?{required:!0}:{}})]}),(0,m.jsx)("button",{type:"submit",className:"btn btn-primary",children:null!==g?"Modifier":"Ajouter"}),null!==g&&(0,m.jsx)("button",{type:"button",className:"btn btn-secondary ms-2",onClick:()=>{j(null),N(null),S("")},children:"Annuler"})]}),0===f.length?(0,m.jsx)("p",{children:"Aucun mat\xe9riel roulant ajout\xe9 pour cette r\xe9gion."}):(0,m.jsx)("div",{className:"row",children:f.map(e=>(0,m.jsx)("div",{className:"col-md-4 mb-4",children:(0,m.jsxs)("div",{className:"card",children:[(0,m.jsx)("img",{src:e.imageData,alt:e.imageName,className:"card-img-top",style:{maxHeight:"200px",objectFit:"contain"}}),(0,m.jsxs)("div",{className:"card-body",children:[(0,m.jsx)("h5",{className:"card-title",children:e.imageName}),(0,m.jsx)("button",{className:"btn btn-warning btn-sm me-2",onClick:()=>M(e),children:"Modifier"}),(0,m.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>C(e.id),children:"Supprimer"})]})]})},e.id))})]}):(0,m.jsx)("p",{children:"Veuillez s\xe9lectionner une r\xe9gion pour g\xe9rer ses mat\xe9riels roulants."})]})]})})]})}let f=(0,l.M)(t,"default"),p=(0,l.M)(t,"getStaticProps"),g=(0,l.M)(t,"getStaticPaths"),j=(0,l.M)(t,"getServerSideProps"),v=(0,l.M)(t,"config"),N=(0,l.M)(t,"reportWebVitals"),b=(0,l.M)(t,"unstable_getStaticProps"),S=(0,l.M)(t,"unstable_getStaticPaths"),y=(0,l.M)(t,"unstable_getStaticParams"),k=(0,l.M)(t,"unstable_getServerProps"),w=(0,l.M)(t,"unstable_getServerSideProps"),C=new i.PagesRouteModule({definition:{kind:r.A.PAGES,page:"/admin/materiels-roulants",pathname:"/admin/materiels-roulants",bundlePath:"",filename:""},components:{App:o.default,Document:c()},userland:t})}};var a=require("../../webpack-runtime.js");a.C(e);var s=e=>a(a.s=e),t=a.X(0,[89,466,616,358],()=>s(9597));module.exports=t})();