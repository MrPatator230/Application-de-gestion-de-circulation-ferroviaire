(()=>{var e={};e.id=913,e.ids=[220,636,913],e.modules={361:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},468:(e,a,s)=>{"use strict";s.d(a,{Z:()=>n,l:()=>r});var t=s(8732),i=s(2015);let r=(0,i.createContext)(),n=({children:e})=>{let[a,s]=(0,i.useState)("Ma Soci\xe9t\xe9 Ferroviaire"),[n,l]=(0,i.useState)("Le transport ferroviaire simplifi\xe9"),[c,d]=(0,i.useState)("Description de la soci\xe9t\xe9 ferroviaire..."),[o,m]=(0,i.useState)("#007bff"),[u,h]=(0,i.useState)("#6c757d"),[p,x]=(0,i.useState)("Train Schedule Management");return(0,i.useEffect)(()=>{!async function(){try{let e=await fetch("/api/settings");if(e.ok){let a=await e.json();s(a.companyName||"Ma Soci\xe9t\xe9 Ferroviaire"),l(a.companySlogan||"Le transport ferroviaire simplifi\xe9"),d(a.companyDescription||"Description de la soci\xe9t\xe9 ferroviaire..."),m(a.primaryColor||"#007bff"),h(a.secondaryColor||"#6c757d"),x(a.appName||"Train Schedule Management")}}catch(e){console.error("Failed to fetch settings:",e)}}()},[]),(0,t.jsx)(r.Provider,{value:{companyName:a,setCompanyName:s,companySlogan:n,setCompanySlogan:l,companyDescription:c,setCompanyDescription:d,primaryColor:o,setPrimaryColor:m,secondaryColor:u,setSecondaryColor:h,appName:p,setAppName:x},children:e})}},2015:e=>{"use strict";e.exports=require("react")},2326:e=>{"use strict";e.exports=require("react-dom")},2768:()=>{},2793:(e,a,s)=>{"use strict";s.r(a),s.d(a,{config:()=>g,default:()=>x,getServerSideProps:()=>v,getStaticPaths:()=>j,getStaticProps:()=>f,reportWebVitals:()=>b,routeModule:()=>w,unstable_getServerProps:()=>k,unstable_getServerSideProps:()=>T,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>S,unstable_getStaticProps:()=>N});var t={};s.r(t),s.d(t,{default:()=>p});var i=s(3885),r=s(237),n=s(1413),l=s(9616),c=s.n(l),d=s(3673),o=s(8732),m=s(2015),u=s(5624);let h={Retard:"bg-warning text-dark",Suppression:"bg-danger",Information:"bg-primary",Modification:"bg-info text-dark"};function p(){let[e,a]=(0,m.useState)([]),[s,t]=(0,m.useState)([]),[i,r]=(0,m.useState)([]),[n,l]=(0,m.useState)({id:null,title:"",startDate:"",endDate:"",description:"",impactType:"",impactedTrains:[]}),[c,d]=(0,m.useState)(""),[p,x]=(0,m.useState)([]),f=e=>{localStorage.setItem("trafficInfos",JSON.stringify(e))},j=e=>{let{name:a,value:s}=e.target;l(e=>({...e,[a]:s}))},v=e=>{l(a=>{let s=a.impactedTrains.includes(e)?a.impactedTrains.filter(a=>a!==e):[...a.impactedTrains,e];return{...a,impactedTrains:s}})},g=a=>{let s=e.find(e=>e.id===a);s&&l(s)},b=s=>{if(confirm("Voulez-vous vraiment supprimer cette info trafic ?")){let t=e.filter(e=>e.id!==s);a(t),f(t)}};return(0,o.jsxs)("div",{id:"wrapper",style:{display:"flex",minHeight:"100vh"},children:[(0,o.jsx)(u.A,{}),(0,o.jsx)("div",{id:"content-wrapper",className:"d-flex flex-column flex-grow-1",children:(0,o.jsxs)("div",{id:"content",className:"container my-5 flex-grow-1",children:[(0,o.jsx)("h1",{className:"mb-4 text-center",children:"Gestion des Infos Trafic"}),(0,o.jsxs)("form",{onSubmit:s=>{let t;if(s.preventDefault(),!n.title||!n.description||!n.impactType)return void alert("Veuillez remplir les champs obligatoires : Titre, Description, Type d'impact.");a(t=null===n.id?[...e,{...n,id:Date.now()}]:e.map(e=>e.id===n.id?n:e)),f(t),l({id:null,title:"",startDate:"",endDate:"",description:"",impactType:"",impactedTrains:[]}),d("")},className:"mb-5",children:[(0,o.jsxs)("div",{className:"mb-3",children:[(0,o.jsx)("label",{htmlFor:"title",className:"form-label",children:"Titre *"}),(0,o.jsx)("input",{type:"text",id:"title",name:"title",className:"form-control",value:n.title,onChange:j,required:!0})]}),(0,o.jsxs)("div",{className:"mb-3 d-flex gap-3",children:[(0,o.jsxs)("div",{className:"flex-grow-1",children:[(0,o.jsx)("label",{htmlFor:"startDate",className:"form-label",children:"De (optionnel)"}),(0,o.jsx)("input",{type:"date",id:"startDate",name:"startDate",className:"form-control",value:n.startDate,onChange:j})]}),(0,o.jsxs)("div",{className:"flex-grow-1",children:[(0,o.jsx)("label",{htmlFor:"endDate",className:"form-label",children:"\xc0 (optionnel)"}),(0,o.jsx)("input",{type:"date",id:"endDate",name:"endDate",className:"form-control",value:n.endDate,onChange:j})]})]}),(0,o.jsxs)("div",{className:"mb-3",children:[(0,o.jsx)("label",{htmlFor:"description",className:"form-label",children:"Description *"}),(0,o.jsx)("textarea",{id:"description",name:"description",className:"form-control",rows:"3",value:n.description,onChange:j,required:!0})]}),(0,o.jsxs)("div",{className:"mb-3",children:[(0,o.jsx)("label",{htmlFor:"impactType",className:"form-label",children:"Type d'impact sur le r\xe9seau *"}),(0,o.jsxs)("select",{id:"impactType",name:"impactType",className:"form-select",value:n.impactType,onChange:j,required:!0,children:[(0,o.jsx)("option",{value:"",children:"-- S\xe9lectionnez un type --"}),(0,o.jsx)("option",{value:"Retard",children:"Retard"}),(0,o.jsx)("option",{value:"Suppression",children:"Suppression"}),(0,o.jsx)("option",{value:"Modification",children:"Modification"}),(0,o.jsx)("option",{value:"Information",children:"Information"})]})]}),(0,o.jsxs)("div",{className:"mb-3",children:[(0,o.jsx)("label",{htmlFor:"trainSearch",className:"form-label",children:"Horaires impact\xe9s (rechercher un num\xe9ro de train)"}),(0,o.jsx)("input",{type:"text",id:"trainSearch",className:"form-control",placeholder:"Rechercher un num\xe9ro de train",value:c,onChange:e=>d(e.target.value)}),(0,o.jsxs)("div",{className:"mt-2",style:{maxHeight:"150px",overflowY:"auto",border:"1px solid #ced4da",borderRadius:"0.25rem"},children:[0===p.length&&(0,o.jsx)("p",{className:"text-muted p-2",children:"Aucun train trouv\xe9."}),p.map(e=>(0,o.jsxs)("div",{className:"form-check",children:[(0,o.jsx)("input",{className:"form-check-input",type:"checkbox",id:`train-${e.id}`,checked:n.impactedTrains.includes(e.trainNumber),onChange:()=>v(e.trainNumber)}),(0,o.jsxs)("label",{className:"form-check-label",htmlFor:`train-${e.id}`,children:[e.trainNumber," - ",e.departureStation," â†’ ",e.arrivalStation]})]},e.id))]})]}),(0,o.jsx)("button",{type:"submit",className:"btn btn-primary",children:null===n.id?"Cr\xe9er":"Mettre \xe0 jour"})]}),(0,o.jsx)("h2",{className:"mb-3",children:"Infos Trafic existantes"}),0===e.length?(0,o.jsx)("p",{children:"Aucune info trafic enregistr\xe9e."}):(0,o.jsx)("div",{className:"table-responsive",children:(0,o.jsxs)("table",{className:"table table-bordered align-middle",children:[(0,o.jsx)("thead",{className:"table-light",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:"Titre"}),(0,o.jsx)("th",{children:"De quand \xe0 quand"}),(0,o.jsx)("th",{children:"Description"}),(0,o.jsx)("th",{children:"Type d'impact"}),(0,o.jsx)("th",{children:"Horaires impact\xe9s"}),(0,o.jsx)("th",{children:"Actions"})]})}),(0,o.jsx)("tbody",{children:e.map(e=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:e.title}),(0,o.jsxs)("td",{children:[e.startDate||"-"," ",e.endDate?`\xe0 ${e.endDate}`:""]}),(0,o.jsx)("td",{children:e.description}),(0,o.jsx)("td",{children:(0,o.jsx)("span",{className:`badge ${h[e.impactType]||"bg-secondary"}`,children:e.impactType})}),(0,o.jsx)("td",{children:0===e.impactedTrains.length?"-":e.impactedTrains.join(", ")}),(0,o.jsxs)("td",{children:[(0,o.jsx)("button",{className:"btn btn-sm btn-warning me-2",onClick:()=>g(e.id),children:"Modifier"}),(0,o.jsx)("button",{className:"btn btn-sm btn-danger",onClick:()=>b(e.id),children:"Supprimer"})]})]},e.id))})]})})]})})]})}let x=(0,n.M)(t,"default"),f=(0,n.M)(t,"getStaticProps"),j=(0,n.M)(t,"getStaticPaths"),v=(0,n.M)(t,"getServerSideProps"),g=(0,n.M)(t,"config"),b=(0,n.M)(t,"reportWebVitals"),N=(0,n.M)(t,"unstable_getStaticProps"),S=(0,n.M)(t,"unstable_getStaticPaths"),y=(0,n.M)(t,"unstable_getStaticParams"),k=(0,n.M)(t,"unstable_getServerProps"),T=(0,n.M)(t,"unstable_getServerSideProps"),w=new i.PagesRouteModule({definition:{kind:r.A.PAGES,page:"/admin/info-trafics",pathname:"/admin/info-trafics",bundlePath:"",filename:""},components:{App:d.default,Document:c()},userland:t})},3673:(e,a,s)=>{"use strict";s.r(a),s.d(a,{AuthContext:()=>m,default:()=>h});var t=s(8732);let i=require("styled-jsx/style");var r=s.n(i);s(5378),s(2768);var n=s(2015),l=s(4233),c=s(9788),d=s.n(c),o=s(468);let m=(0,n.createContext)();function u({children:e}){let{primaryColor:a,secondaryColor:s,appName:i}=(0,n.useContext)(o.l);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r(),{id:"f1209dfa6dead71",dynamic:[a,s],children:`:root{--bs-primary:${a};--bs-secondary:${s}}`}),e]})}function h({Component:e,pageProps:a}){let[s,i]=(0,n.useState)(!1),[r,c]=(0,n.useState)(null),h=(0,l.useRouter)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(d(),{children:[(0,t.jsx)("link",{href:"https://cdn.jsdelivr.net/npm/startbootstrap-sb-admin-2@4.1.4/css/sb-admin-2.min.css",rel:"stylesheet"}),(0,t.jsx)("link",{href:"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css",rel:"stylesheet"})]}),(0,t.jsx)(m.Provider,{value:{isAuthenticated:s,role:r,login:(e,a)=>"admin"===e&&"admin"===a?(localStorage.setItem("authToken","dummy-token"),localStorage.setItem("userRole","admin"),localStorage.setItem("username",e),i(!0),c("admin"),h.push("/admin"),!0):!!JSON.parse(localStorage.getItem("users")||"[]").find(s=>s.username===e&&s.password===a)&&(localStorage.setItem("authToken","dummy-token"),localStorage.setItem("userRole","client"),localStorage.setItem("username",e),i(!0),c("client"),h.push("/client"),!0),logout:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("username"),i(!1),c(null),h.push("/login")},register:(e,a)=>{let s=JSON.parse(localStorage.getItem("users")||"[]");return!s.find(a=>a.username===e)&&(s.push({username:e,password:a}),localStorage.setItem("users",JSON.stringify(s)),localStorage.setItem("authToken","dummy-token"),localStorage.setItem("userRole","client"),localStorage.setItem("username",e),i(!0),c("client"),h.push("/client"),!0)}},children:(0,t.jsx)(o.Z,{children:(0,t.jsx)(u,{children:(0,t.jsx)(e,{...a})})})})]})}},3873:e=>{"use strict";e.exports=require("path")},4075:e=>{"use strict";e.exports=require("zlib")},5624:(e,a,s)=>{"use strict";s.d(a,{A:()=>o});var t=s(8732),i=s(9918),r=s.n(i),n=s(4233),l=s(2015),c=s(3673),d=s(468);function o(){let e=(0,n.useRouter)().pathname,{logout:a}=(0,l.useContext)(c.AuthContext),{companyName:s}=(0,l.useContext)(d.l);return(0,t.jsxs)("ul",{className:"navbar-nav bg-gradient-primary sidebar sidebar-dark accordion d-flex flex-column",id:"accordionSidebar",style:{height:"100vh",position:"sticky",top:0},children:[(0,t.jsxs)(r(),{href:"/admin",className:"sidebar-brand d-flex align-items-center justify-content-center",children:[(0,t.jsx)("div",{className:"sidebar-brand-icon",children:(0,t.jsx)("i",{className:"fas fa-train"})}),(0,t.jsx)("div",{className:"sidebar-brand-text mx-3",children:s})]}),(0,t.jsx)("hr",{className:"sidebar-divider my-0"}),(0,t.jsx)("li",{className:`nav-item ${"/admin"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/admin",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-tachometer-alt"}),(0,t.jsx)("span",{children:"Dashboard"})]})}),(0,t.jsx)("li",{className:`nav-item ${"/admin/entreprise"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/admin/entreprise",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-building"}),(0,t.jsx)("span",{children:"Entreprise"})]})}),(0,t.jsx)("li",{className:`nav-item ${"/stations"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/stations",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-train"}),(0,t.jsx)("span",{children:"Gestion de gares"})]})}),(0,t.jsx)("li",{className:`nav-item ${"/admin/horaires"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/admin/horaires",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-clock"}),(0,t.jsx)("span",{children:"Horaires"})]})}),(0,t.jsx)("li",{className:`nav-item ${"/admin/materiels-roulants"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/admin/materiels-roulants",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-cogs"}),(0,t.jsx)("span",{children:"Mat\xe9riels Roulants"})]})}),(0,t.jsx)("li",{className:`nav-item ${"/admin/info-trafics"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/admin/info-trafics",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-info-circle"}),(0,t.jsx)("span",{children:"Infos Trafic"})]})}),(0,t.jsx)("li",{className:`nav-item ${"/admin/attribution-voie"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/admin/attribution-voie",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-map-signs"}),(0,t.jsx)("span",{children:"Attribution Voie"})]})}),(0,t.jsx)("li",{className:`nav-item ${"/admin/type-horaires"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/admin/type-horaires",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-clock"}),(0,t.jsx)("span",{children:"Type Horaires"})]})}),(0,t.jsx)("li",{className:`nav-item ${"/admin/sauvegarde"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/admin/sauvegarde",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-save"}),(0,t.jsx)("span",{children:"Sauvegarde"})]})}),(0,t.jsx)("li",{className:`nav-item ${"/admin/update"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/admin/update",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-sync-alt"}),(0,t.jsx)("span",{children:"Mise \xe0 jour"})]})}),(0,t.jsx)("li",{className:`nav-item ${"/admin/actualites"===e?"active":""}`,children:(0,t.jsxs)(r(),{href:"/admin/actualites",className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-fw fa-newspaper"}),(0,t.jsx)("span",{children:"Actualit\xe9s"})]})}),(0,t.jsx)("hr",{className:"sidebar-divider mt-auto"}),(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsxs)("a",{href:"#",onClick:e=>{e.preventDefault(),a()},className:"nav-link",children:[(0,t.jsx)("i",{className:"fas fa-sign-out-alt"}),(0,t.jsx)("span",{children:"D\xe9connexion"})]})})]})}},7910:e=>{"use strict";e.exports=require("stream")},8732:e=>{"use strict";e.exports=require("react/jsx-runtime")},9021:e=>{"use strict";e.exports=require("fs")}};var a=require("../../webpack-runtime.js");a.C(e);var s=e=>a(a.s=e),t=a.X(0,[89,466,616,358],()=>s(2793));module.exports=t})();