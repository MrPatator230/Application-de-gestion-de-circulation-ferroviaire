"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/audio-files";
exports.ids = ["pages/api/audio-files"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Faudio-files&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Faudio-files.js&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Faudio-files&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Faudio-files.js&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_audio_files_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/audio-files.js */ \"(api)/./pages/api/audio-files.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_audio_files_js__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_audio_files_js__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/audio-files\",\n        pathname: \"/api/audio-files\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_audio_files_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmF1ZGlvLWZpbGVzJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlMkZhcGklMkZhdWRpby1maWxlcy5qcyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDRTtBQUMxRDtBQUN1RDtBQUN2RDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsc0RBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLHNEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLHlHQUFtQjtBQUNsRDtBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXMvYXBpL2F1ZGlvLWZpbGVzLmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsICdkZWZhdWx0Jyk7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCAnY29uZmlnJyk7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hdWRpby1maWxlc1wiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2F1ZGlvLWZpbGVzXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogJycsXG4gICAgICAgIGZpbGVuYW1lOiAnJ1xuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Faudio-files&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Faudio-files.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/audio-files.js":
/*!**********************************!*\
  !*** ./pages/api/audio-files.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n\n\n// Define paths\nconst audioDir = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), 'public', 'audio');\nconst foldersFile = path__WEBPACK_IMPORTED_MODULE_1___default().join(audioDir, 'folders.json');\nconst metadataFile = path__WEBPACK_IMPORTED_MODULE_1___default().join(audioDir, 'metadata.json');\n// Ensure directories and files exist\nif (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(audioDir)) {\n    fs__WEBPACK_IMPORTED_MODULE_0___default().mkdirSync(audioDir, {\n        recursive: true\n    });\n}\nif (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(foldersFile)) {\n    fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(foldersFile, JSON.stringify({\n        folders: []\n    }));\n}\nif (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(metadataFile)) {\n    fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(metadataFile, JSON.stringify({}));\n}\n// Helper functions\nfunction getFolders() {\n    try {\n        const data = fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(foldersFile, 'utf8');\n        return JSON.parse(data).folders;\n    } catch (error) {\n        console.error('Error reading folders:', error);\n        return [];\n    }\n}\nfunction saveFolders(folders) {\n    fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(foldersFile, JSON.stringify({\n        folders\n    }, null, 2));\n}\nfunction getMetadata() {\n    try {\n        const data = fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(metadataFile, 'utf8');\n        return JSON.parse(data);\n    } catch (error) {\n        console.error('Error reading metadata:', error);\n        return {};\n    }\n}\nfunction saveMetadata(metadata) {\n    fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(metadataFile, JSON.stringify(metadata, null, 2));\n}\nfunction findFileByIdWithExtension(fileId) {\n    try {\n        const files = fs__WEBPACK_IMPORTED_MODULE_0___default().readdirSync(audioDir);\n        return files.find((file)=>file !== 'folders.json' && file !== 'metadata.json' && file.startsWith(fileId));\n    } catch (error) {\n        console.error('Error finding file:', error);\n        return null;\n    }\n}\nasync function handler(req, res) {\n    const { method, query } = req;\n    try {\n        switch(method){\n            case 'GET':\n                // List files or folders\n                if (query.type === 'folders') {\n                    const folders = getFolders();\n                    res.status(200).json({\n                        folders\n                    });\n                } else {\n                    const folderId = query.folderId;\n                    const metadata = getMetadata();\n                    // Get all files in the audio directory\n                    const files = fs__WEBPACK_IMPORTED_MODULE_0___default().readdirSync(audioDir).filter((file)=>file !== 'folders.json' && file !== 'metadata.json').map((filename)=>{\n                        const id = filename.split('-')[0]; // Get the ID part before the first hyphen\n                        const fileMetadata = metadata[id] || {};\n                        const stats = fs__WEBPACK_IMPORTED_MODULE_0___default().statSync(path__WEBPACK_IMPORTED_MODULE_1___default().join(audioDir, filename));\n                        return {\n                            id,\n                            name: fileMetadata.name || filename,\n                            url: `/audio/${filename}`,\n                            folderId: fileMetadata.folderId || null,\n                            size: stats.size,\n                            type: fileMetadata.type || 'audio/mpeg',\n                            createdAt: fileMetadata.createdAt || stats.birthtime\n                        };\n                    }).filter((file)=>{\n                        // If a folder ID is provided, only return files in that folder\n                        if (folderId) {\n                            const fileMetadata = metadata[file.id];\n                            return fileMetadata && fileMetadata.folderId === folderId;\n                        }\n                        // If no folder ID is provided, return files that are not in any folder\n                        return !metadata[file.id]?.folderId;\n                    });\n                    res.status(200).json({\n                        files\n                    });\n                }\n                break;\n            case 'POST':\n                // Create new folder\n                if (query.type === 'folders') {\n                    const { name } = req.body;\n                    if (!name) {\n                        return res.status(400).json({\n                            error: 'Le nom du dossier est requis'\n                        });\n                    }\n                    const folders = getFolders();\n                    const newFolder = {\n                        id: Date.now().toString(),\n                        name,\n                        createdAt: new Date().toISOString()\n                    };\n                    folders.push(newFolder);\n                    saveFolders(folders);\n                    res.status(201).json(newFolder);\n                } else {\n                    res.status(400).json({\n                        error: 'Opération invalide'\n                    });\n                }\n                break;\n            case 'PUT':\n                if (query.type === 'folders' && query.id) {\n                    // Rename folder\n                    const { name } = req.body;\n                    const folders = getFolders();\n                    const folderIndex = folders.findIndex((f)=>f.id === query.id);\n                    if (folderIndex === -1) {\n                        return res.status(404).json({\n                            error: 'Dossier non trouvé'\n                        });\n                    }\n                    folders[folderIndex].name = name;\n                    saveFolders(folders);\n                    res.status(200).json(folders[folderIndex]);\n                } else if (query.type === 'move' && query.id) {\n                    // Move file to different folder\n                    const { folderId } = req.body;\n                    const metadata = getMetadata();\n                    if (!metadata[query.id]) {\n                        metadata[query.id] = {};\n                    }\n                    metadata[query.id].folderId = folderId;\n                    saveMetadata(metadata);\n                    res.status(200).json({\n                        success: true\n                    });\n                } else if (query.type === 'rename' && query.id) {\n                    // Rename file\n                    const { name } = req.body;\n                    const metadata = getMetadata();\n                    if (!metadata[query.id]) {\n                        metadata[query.id] = {};\n                    }\n                    metadata[query.id].name = name;\n                    saveMetadata(metadata);\n                    res.status(200).json({\n                        success: true\n                    });\n                } else {\n                    res.status(400).json({\n                        error: 'Opération invalide'\n                    });\n                }\n                break;\n            case 'DELETE':\n                if (query.type === 'folders' && query.id) {\n                    // Delete folder\n                    const folders = getFolders();\n                    const newFolders = folders.filter((f)=>f.id !== query.id); // Fixed the condition here\n                    saveFolders(newFolders);\n                    // Update files in the folder to have no folder\n                    const metadata = getMetadata();\n                    Object.keys(metadata).forEach((fileId)=>{\n                        if (metadata[fileId].folderId === query.id) {\n                            metadata[fileId].folderId = null;\n                        }\n                    });\n                    saveMetadata(metadata);\n                    res.status(200).json({\n                        success: true\n                    });\n                } else if (query.id) {\n                    // Delete file\n                    const filename = findFileByIdWithExtension(query.id);\n                    if (!filename) {\n                        return res.status(404).json({\n                            error: 'Fichier non trouvé'\n                        });\n                    }\n                    const filePath = path__WEBPACK_IMPORTED_MODULE_1___default().join(audioDir, filename);\n                    try {\n                        // Delete the physical file\n                        fs__WEBPACK_IMPORTED_MODULE_0___default().unlinkSync(filePath);\n                        // Remove from metadata\n                        const metadata = getMetadata();\n                        delete metadata[query.id];\n                        saveMetadata(metadata);\n                        res.status(200).json({\n                            success: true\n                        });\n                    } catch (error) {\n                        console.error('Error deleting file:', error);\n                        res.status(500).json({\n                            error: 'Erreur lors de la suppression du fichier: ' + error.message\n                        });\n                    }\n                } else {\n                    res.status(400).json({\n                        error: 'Opération invalide'\n                    });\n                }\n                break;\n            default:\n                res.setHeader('Allow', [\n                    'GET',\n                    'POST',\n                    'PUT',\n                    'DELETE'\n                ]);\n                res.status(405).end(`Method ${method} Not Allowed`);\n        }\n    } catch (error) {\n        console.error('API Error:', error);\n        res.status(500).json({\n            error: 'Erreur interne du serveur: ' + error.message\n        });\n    }\n}\nconst config = {\n    api: {\n        bodyParser: true\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUM7WUFBRXBCLE9BQU8sZ0NBQWdDQSxNQUFNb0QsT0FBTztRQUFDO0lBQzlFO0FBQ0Y7QUFFTyxNQUFNRyxTQUFTO0lBQ3BCQyxLQUFLO1FBQ0hDLFlBQVk7SUFDZDtBQUNGLEVBQUUiLCJzb3VyY2VzIjpbIi9Vc2Vycy9tYXRoaXNncmlsbG90L0RvY3VtZW50cy9HaXRIdWIvQXBwbGljYXRpb24tZGUtZ2VzdGlvbi1kZS1jaXJjdWxhdGlvbi1mZXJyb3ZpYWlyZS9wYWdlcy9hcGkvYXVkaW8tZmlsZXMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGZzIGZyb20gJ2ZzJztcclxuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XHJcblxyXG4vLyBEZWZpbmUgcGF0aHNcclxuY29uc3QgYXVkaW9EaXIgPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3B1YmxpYycsICdhdWRpbycpO1xyXG5jb25zdCBmb2xkZXJzRmlsZSA9IHBhdGguam9pbihhdWRpb0RpciwgJ2ZvbGRlcnMuanNvbicpO1xyXG5jb25zdCBtZXRhZGF0YUZpbGUgPSBwYXRoLmpvaW4oYXVkaW9EaXIsICdtZXRhZGF0YS5qc29uJyk7XHJcblxyXG4vLyBFbnN1cmUgZGlyZWN0b3JpZXMgYW5kIGZpbGVzIGV4aXN0XHJcbmlmICghZnMuZXhpc3RzU3luYyhhdWRpb0RpcikpIHtcclxuICBmcy5ta2RpclN5bmMoYXVkaW9EaXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xyXG59XHJcblxyXG5pZiAoIWZzLmV4aXN0c1N5bmMoZm9sZGVyc0ZpbGUpKSB7XHJcbiAgZnMud3JpdGVGaWxlU3luYyhmb2xkZXJzRmlsZSwgSlNPTi5zdHJpbmdpZnkoeyBmb2xkZXJzOiBbXSB9KSk7XHJcbn1cclxuXHJcbmlmICghZnMuZXhpc3RzU3luYyhtZXRhZGF0YUZpbGUpKSB7XHJcbiAgZnMud3JpdGVGaWxlU3luYyhtZXRhZGF0YUZpbGUsIEpTT04uc3RyaW5naWZ5KHt9KSk7XHJcbn1cclxuXHJcbi8vIEhlbHBlciBmdW5jdGlvbnNcclxuZnVuY3Rpb24gZ2V0Rm9sZGVycygpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgZGF0YSA9IGZzLnJlYWRGaWxlU3luYyhmb2xkZXJzRmlsZSwgJ3V0ZjgnKTtcclxuICAgIHJldHVybiBKU09OLnBhcnNlKGRhdGEpLmZvbGRlcnM7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlYWRpbmcgZm9sZGVyczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBzYXZlRm9sZGVycyhmb2xkZXJzKSB7XHJcbiAgZnMud3JpdGVGaWxlU3luYyhmb2xkZXJzRmlsZSwgSlNPTi5zdHJpbmdpZnkoeyBmb2xkZXJzIH0sIG51bGwsIDIpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0TWV0YWRhdGEoKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGRhdGEgPSBmcy5yZWFkRmlsZVN5bmMobWV0YWRhdGFGaWxlLCAndXRmOCcpO1xyXG4gICAgcmV0dXJuIEpTT04ucGFyc2UoZGF0YSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlYWRpbmcgbWV0YWRhdGE6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHt9O1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gc2F2ZU1ldGFkYXRhKG1ldGFkYXRhKSB7XHJcbiAgZnMud3JpdGVGaWxlU3luYyhtZXRhZGF0YUZpbGUsIEpTT04uc3RyaW5naWZ5KG1ldGFkYXRhLCBudWxsLCAyKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGZpbmRGaWxlQnlJZFdpdGhFeHRlbnNpb24oZmlsZUlkKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGZpbGVzID0gZnMucmVhZGRpclN5bmMoYXVkaW9EaXIpO1xyXG4gICAgcmV0dXJuIGZpbGVzLmZpbmQoZmlsZSA9PiBcclxuICAgICAgZmlsZSAhPT0gJ2ZvbGRlcnMuanNvbicgJiYgXHJcbiAgICAgIGZpbGUgIT09ICdtZXRhZGF0YS5qc29uJyAmJiBcclxuICAgICAgZmlsZS5zdGFydHNXaXRoKGZpbGVJZClcclxuICAgICk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgZmlsZTonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcclxuICBjb25zdCB7IG1ldGhvZCwgcXVlcnkgfSA9IHJlcTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIHN3aXRjaCAobWV0aG9kKSB7XHJcbiAgICAgIGNhc2UgJ0dFVCc6XHJcbiAgICAgICAgLy8gTGlzdCBmaWxlcyBvciBmb2xkZXJzXHJcbiAgICAgICAgaWYgKHF1ZXJ5LnR5cGUgPT09ICdmb2xkZXJzJykge1xyXG4gICAgICAgICAgY29uc3QgZm9sZGVycyA9IGdldEZvbGRlcnMoKTtcclxuICAgICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgZm9sZGVycyB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY29uc3QgZm9sZGVySWQgPSBxdWVyeS5mb2xkZXJJZDtcclxuICAgICAgICAgIGNvbnN0IG1ldGFkYXRhID0gZ2V0TWV0YWRhdGEoKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gR2V0IGFsbCBmaWxlcyBpbiB0aGUgYXVkaW8gZGlyZWN0b3J5XHJcbiAgICAgICAgICBjb25zdCBmaWxlcyA9IGZzLnJlYWRkaXJTeW5jKGF1ZGlvRGlyKVxyXG4gICAgICAgICAgICAuZmlsdGVyKGZpbGUgPT4gZmlsZSAhPT0gJ2ZvbGRlcnMuanNvbicgJiYgZmlsZSAhPT0gJ21ldGFkYXRhLmpzb24nKVxyXG4gICAgICAgICAgICAubWFwKGZpbGVuYW1lID0+IHtcclxuICAgICAgICAgICAgICBjb25zdCBpZCA9IGZpbGVuYW1lLnNwbGl0KCctJylbMF07IC8vIEdldCB0aGUgSUQgcGFydCBiZWZvcmUgdGhlIGZpcnN0IGh5cGhlblxyXG4gICAgICAgICAgICAgIGNvbnN0IGZpbGVNZXRhZGF0YSA9IG1ldGFkYXRhW2lkXSB8fCB7fTtcclxuICAgICAgICAgICAgICBjb25zdCBzdGF0cyA9IGZzLnN0YXRTeW5jKHBhdGguam9pbihhdWRpb0RpciwgZmlsZW5hbWUpKTtcclxuICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgaWQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBmaWxlTWV0YWRhdGEubmFtZSB8fCBmaWxlbmFtZSxcclxuICAgICAgICAgICAgICAgIHVybDogYC9hdWRpby8ke2ZpbGVuYW1lfWAsXHJcbiAgICAgICAgICAgICAgICBmb2xkZXJJZDogZmlsZU1ldGFkYXRhLmZvbGRlcklkIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICBzaXplOiBzdGF0cy5zaXplLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogZmlsZU1ldGFkYXRhLnR5cGUgfHwgJ2F1ZGlvL21wZWcnLFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBmaWxlTWV0YWRhdGEuY3JlYXRlZEF0IHx8IHN0YXRzLmJpcnRodGltZVxyXG4gICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5maWx0ZXIoZmlsZSA9PiB7XHJcbiAgICAgICAgICAgICAgLy8gSWYgYSBmb2xkZXIgSUQgaXMgcHJvdmlkZWQsIG9ubHkgcmV0dXJuIGZpbGVzIGluIHRoYXQgZm9sZGVyXHJcbiAgICAgICAgICAgICAgaWYgKGZvbGRlcklkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlTWV0YWRhdGEgPSBtZXRhZGF0YVtmaWxlLmlkXTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmaWxlTWV0YWRhdGEgJiYgZmlsZU1ldGFkYXRhLmZvbGRlcklkID09PSBmb2xkZXJJZDtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgLy8gSWYgbm8gZm9sZGVyIElEIGlzIHByb3ZpZGVkLCByZXR1cm4gZmlsZXMgdGhhdCBhcmUgbm90IGluIGFueSBmb2xkZXJcclxuICAgICAgICAgICAgICByZXR1cm4gIW1ldGFkYXRhW2ZpbGUuaWRdPy5mb2xkZXJJZDtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBmaWxlcyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlICdQT1NUJzpcclxuICAgICAgICAvLyBDcmVhdGUgbmV3IGZvbGRlclxyXG4gICAgICAgIGlmIChxdWVyeS50eXBlID09PSAnZm9sZGVycycpIHtcclxuICAgICAgICAgIGNvbnN0IHsgbmFtZSB9ID0gcmVxLmJvZHk7XHJcbiAgICAgICAgICBpZiAoIW5hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdMZSBub20gZHUgZG9zc2llciBlc3QgcmVxdWlzJyB9KTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBjb25zdCBmb2xkZXJzID0gZ2V0Rm9sZGVycygpO1xyXG4gICAgICAgICAgY29uc3QgbmV3Rm9sZGVyID0ge1xyXG4gICAgICAgICAgICBpZDogRGF0ZS5ub3coKS50b1N0cmluZygpLFxyXG4gICAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICBmb2xkZXJzLnB1c2gobmV3Rm9sZGVyKTtcclxuICAgICAgICAgIHNhdmVGb2xkZXJzKGZvbGRlcnMpO1xyXG4gICAgICAgICAgcmVzLnN0YXR1cygyMDEpLmpzb24obmV3Rm9sZGVyKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ09ww6lyYXRpb24gaW52YWxpZGUnIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgJ1BVVCc6XHJcbiAgICAgICAgaWYgKHF1ZXJ5LnR5cGUgPT09ICdmb2xkZXJzJyAmJiBxdWVyeS5pZCkge1xyXG4gICAgICAgICAgLy8gUmVuYW1lIGZvbGRlclxyXG4gICAgICAgICAgY29uc3QgeyBuYW1lIH0gPSByZXEuYm9keTtcclxuICAgICAgICAgIGNvbnN0IGZvbGRlcnMgPSBnZXRGb2xkZXJzKCk7XHJcbiAgICAgICAgICBjb25zdCBmb2xkZXJJbmRleCA9IGZvbGRlcnMuZmluZEluZGV4KGYgPT4gZi5pZCA9PT0gcXVlcnkuaWQpO1xyXG5cclxuICAgICAgICAgIGlmIChmb2xkZXJJbmRleCA9PT0gLTEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdEb3NzaWVyIG5vbiB0cm91dsOpJyB9KTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBmb2xkZXJzW2ZvbGRlckluZGV4XS5uYW1lID0gbmFtZTtcclxuICAgICAgICAgIHNhdmVGb2xkZXJzKGZvbGRlcnMpO1xyXG4gICAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oZm9sZGVyc1tmb2xkZXJJbmRleF0pO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocXVlcnkudHlwZSA9PT0gJ21vdmUnICYmIHF1ZXJ5LmlkKSB7XHJcbiAgICAgICAgICAvLyBNb3ZlIGZpbGUgdG8gZGlmZmVyZW50IGZvbGRlclxyXG4gICAgICAgICAgY29uc3QgeyBmb2xkZXJJZCB9ID0gcmVxLmJvZHk7XHJcbiAgICAgICAgICBjb25zdCBtZXRhZGF0YSA9IGdldE1ldGFkYXRhKCk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGlmICghbWV0YWRhdGFbcXVlcnkuaWRdKSB7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhW3F1ZXJ5LmlkXSA9IHt9O1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIG1ldGFkYXRhW3F1ZXJ5LmlkXS5mb2xkZXJJZCA9IGZvbGRlcklkO1xyXG4gICAgICAgICAgc2F2ZU1ldGFkYXRhKG1ldGFkYXRhKTtcclxuICAgICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KTtcclxuICAgICAgICB9IGVsc2UgaWYgKHF1ZXJ5LnR5cGUgPT09ICdyZW5hbWUnICYmIHF1ZXJ5LmlkKSB7XHJcbiAgICAgICAgICAvLyBSZW5hbWUgZmlsZVxyXG4gICAgICAgICAgY29uc3QgeyBuYW1lIH0gPSByZXEuYm9keTtcclxuICAgICAgICAgIGNvbnN0IG1ldGFkYXRhID0gZ2V0TWV0YWRhdGEoKTtcclxuXHJcbiAgICAgICAgICBpZiAoIW1ldGFkYXRhW3F1ZXJ5LmlkXSkge1xyXG4gICAgICAgICAgICBtZXRhZGF0YVtxdWVyeS5pZF0gPSB7fTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBtZXRhZGF0YVtxdWVyeS5pZF0ubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgICBzYXZlTWV0YWRhdGEobWV0YWRhdGEpO1xyXG4gICAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnT3DDqXJhdGlvbiBpbnZhbGlkZScgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSAnREVMRVRFJzpcclxuICAgICAgICBpZiAocXVlcnkudHlwZSA9PT0gJ2ZvbGRlcnMnICYmIHF1ZXJ5LmlkKSB7XHJcbiAgICAgICAgICAvLyBEZWxldGUgZm9sZGVyXHJcbiAgICAgICAgICBjb25zdCBmb2xkZXJzID0gZ2V0Rm9sZGVycygpO1xyXG4gICAgICAgICAgY29uc3QgbmV3Rm9sZGVycyA9IGZvbGRlcnMuZmlsdGVyKGYgPT4gZi5pZCAhPT0gcXVlcnkuaWQpOyAvLyBGaXhlZCB0aGUgY29uZGl0aW9uIGhlcmVcclxuICAgICAgICAgIHNhdmVGb2xkZXJzKG5ld0ZvbGRlcnMpO1xyXG5cclxuICAgICAgICAgIC8vIFVwZGF0ZSBmaWxlcyBpbiB0aGUgZm9sZGVyIHRvIGhhdmUgbm8gZm9sZGVyXHJcbiAgICAgICAgICBjb25zdCBtZXRhZGF0YSA9IGdldE1ldGFkYXRhKCk7XHJcbiAgICAgICAgICBPYmplY3Qua2V5cyhtZXRhZGF0YSkuZm9yRWFjaChmaWxlSWQgPT4ge1xyXG4gICAgICAgICAgICBpZiAobWV0YWRhdGFbZmlsZUlkXS5mb2xkZXJJZCA9PT0gcXVlcnkuaWQpIHtcclxuICAgICAgICAgICAgICBtZXRhZGF0YVtmaWxlSWRdLmZvbGRlcklkID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBzYXZlTWV0YWRhdGEobWV0YWRhdGEpO1xyXG5cclxuICAgICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KTtcclxuICAgICAgICB9IGVsc2UgaWYgKHF1ZXJ5LmlkKSB7XHJcbiAgICAgICAgICAvLyBEZWxldGUgZmlsZVxyXG4gICAgICAgICAgY29uc3QgZmlsZW5hbWUgPSBmaW5kRmlsZUJ5SWRXaXRoRXh0ZW5zaW9uKHF1ZXJ5LmlkKTtcclxuXHJcbiAgICAgICAgICBpZiAoIWZpbGVuYW1lKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnRmljaGllciBub24gdHJvdXbDqScgfSk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLmpvaW4oYXVkaW9EaXIsIGZpbGVuYW1lKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy8gRGVsZXRlIHRoZSBwaHlzaWNhbCBmaWxlXHJcbiAgICAgICAgICAgIGZzLnVubGlua1N5bmMoZmlsZVBhdGgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gUmVtb3ZlIGZyb20gbWV0YWRhdGFcclxuICAgICAgICAgICAgY29uc3QgbWV0YWRhdGEgPSBnZXRNZXRhZGF0YSgpO1xyXG4gICAgICAgICAgICBkZWxldGUgbWV0YWRhdGFbcXVlcnkuaWRdO1xyXG4gICAgICAgICAgICBzYXZlTWV0YWRhdGEobWV0YWRhdGEpO1xyXG5cclxuICAgICAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pO1xyXG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgZmlsZTonLCBlcnJvcik7XHJcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdFcnJldXIgbG9ycyBkZSBsYSBzdXBwcmVzc2lvbiBkdSBmaWNoaWVyOiAnICsgZXJyb3IubWVzc2FnZSB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ09ww6lyYXRpb24gaW52YWxpZGUnIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcmVzLnNldEhlYWRlcignQWxsb3cnLCBbJ0dFVCcsICdQT1NUJywgJ1BVVCcsICdERUxFVEUnXSk7XHJcbiAgICAgICAgcmVzLnN0YXR1cyg0MDUpLmVuZChgTWV0aG9kICR7bWV0aG9kfSBOb3QgQWxsb3dlZGApO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdBUEkgRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0VycmV1ciBpbnRlcm5lIGR1IHNlcnZldXI6ICcgKyBlcnJvci5tZXNzYWdlIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcclxuICBhcGk6IHtcclxuICAgIGJvZHlQYXJzZXI6IHRydWUsXHJcbiAgfSxcclxufTtcclxuIl0sIm5hbWVzIjpbImZzIiwicGF0aCIsImF1ZGlvRGlyIiwiam9pbiIsInByb2Nlc3MiLCJjd2QiLCJmb2xkZXJzRmlsZSIsIm1ldGFkYXRhRmlsZSIsImV4aXN0c1N5bmMiLCJta2RpclN5bmMiLCJyZWN1cnNpdmUiLCJ3cml0ZUZpbGVTeW5jIiwiSlNPTiIsInN0cmluZ2lmeSIsImZvbGRlcnMiLCJnZXRGb2xkZXJzIiwiZGF0YSIsInJlYWRGaWxlU3luYyIsInBhcnNlIiwiZXJyb3IiLCJjb25zb2xlIiwic2F2ZUZvbGRlcnMiLCJnZXRNZXRhZGF0YSIsInNhdmVNZXRhZGF0YSIsIm1ldGFkYXRhIiwiZmluZEZpbGVCeUlkV2l0aEV4dGVuc2lvbiIsImZpbGVJZCIsImZpbGVzIiwicmVhZGRpclN5bmMiLCJmaW5kIiwiZmlsZSIsInN0YXJ0c1dpdGgiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwicXVlcnkiLCJ0eXBlIiwic3RhdHVzIiwianNvbiIsImZvbGRlcklkIiwiZmlsdGVyIiwibWFwIiwiZmlsZW5hbWUiLCJpZCIsInNwbGl0IiwiZmlsZU1ldGFkYXRhIiwic3RhdHMiLCJzdGF0U3luYyIsIm5hbWUiLCJ1cmwiLCJzaXplIiwiY3JlYXRlZEF0IiwiYmlydGh0aW1lIiwiYm9keSIsIm5ld0ZvbGRlciIsIkRhdGUiLCJub3ciLCJ0b1N0cmluZyIsInRvSVNPU3RyaW5nIiwicHVzaCIsImZvbGRlckluZGV4IiwiZmluZEluZGV4IiwiZiIsInN1Y2Nlc3MiLCJuZXdGb2xkZXJzIiwiT2JqZWN0Iiwia2V5cyIsImZvckVhY2giLCJmaWxlUGF0aCIsInVubGlua1N5bmMiLCJtZXNzYWdlIiwic2V0SGVhZGVyIiwiZW5kIiwiY29uZmlnIiwiYXBpIiwiYm9keVBhcnNlciJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/audio-files.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Faudio-files&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Faudio-files.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();