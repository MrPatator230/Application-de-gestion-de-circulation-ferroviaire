"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/audio-files";
exports.ids = ["pages/api/audio-files"];
exports.modules = {

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Faudio-files&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Caudio-files.js&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Faudio-files&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Caudio-files.js&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_audio_files_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\audio-files.js */ \"(api-node)/./pages/api/audio-files.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_audio_files_js__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_audio_files_js__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/audio-files\",\n        pathname: \"/api/audio-files\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_audio_files_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGYXVkaW8tZmlsZXMmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyU1Q2FwaSU1Q2F1ZGlvLWZpbGVzLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUErRjtBQUN2QztBQUNFO0FBQzFEO0FBQ3lEO0FBQ3pEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxzREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsc0RBQVE7QUFDcEM7QUFDTyx3QkFBd0IseUdBQW1CO0FBQ2xEO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcYXVkaW8tZmlsZXMuanNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgJ2RlZmF1bHQnKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsICdjb25maWcnKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2F1ZGlvLWZpbGVzXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYXVkaW8tZmlsZXNcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiAnJyxcbiAgICAgICAgZmlsZW5hbWU6ICcnXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Faudio-files&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Caudio-files.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./pages/api/audio-files.js":
/*!**********************************!*\
  !*** ./pages/api/audio-files.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n\n\n// Define paths\nconst audioDir = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), 'public', 'audio');\nconst foldersFile = path__WEBPACK_IMPORTED_MODULE_1___default().join(audioDir, 'folders.json');\nconst metadataFile = path__WEBPACK_IMPORTED_MODULE_1___default().join(audioDir, 'metadata.json');\n// Ensure directories and files exist\nif (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(audioDir)) {\n    fs__WEBPACK_IMPORTED_MODULE_0___default().mkdirSync(audioDir, {\n        recursive: true\n    });\n}\nif (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(foldersFile)) {\n    fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(foldersFile, JSON.stringify({\n        folders: []\n    }));\n}\nif (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(metadataFile)) {\n    fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(metadataFile, JSON.stringify({}));\n}\n// Helper functions\nfunction getFolders() {\n    try {\n        const data = fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(foldersFile, 'utf8');\n        return JSON.parse(data).folders;\n    } catch (error) {\n        console.error('Error reading folders:', error);\n        return [];\n    }\n}\nfunction saveFolders(folders) {\n    fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(foldersFile, JSON.stringify({\n        folders\n    }, null, 2));\n}\nfunction getMetadata() {\n    try {\n        const data = fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(metadataFile, 'utf8');\n        return JSON.parse(data);\n    } catch (error) {\n        console.error('Error reading metadata:', error);\n        return {};\n    }\n}\nfunction saveMetadata(metadata) {\n    fs__WEBPACK_IMPORTED_MODULE_0___default().writeFileSync(metadataFile, JSON.stringify(metadata, null, 2));\n}\nfunction findFileByIdWithExtension(fileId) {\n    try {\n        const files = fs__WEBPACK_IMPORTED_MODULE_0___default().readdirSync(audioDir);\n        return files.find((file)=>file !== 'folders.json' && file !== 'metadata.json' && file.startsWith(fileId));\n    } catch (error) {\n        console.error('Error finding file:', error);\n        return null;\n    }\n}\nasync function handler(req, res) {\n    const { method, query } = req;\n    try {\n        switch(method){\n            case 'GET':\n                // List files or folders\n                if (query.type === 'folders') {\n                    const folders = getFolders();\n                    res.status(200).json({\n                        folders\n                    });\n                } else {\n                    const folderId = query.folderId;\n                    const metadata = getMetadata();\n                    // Get all files in the audio directory\n                    const files = fs__WEBPACK_IMPORTED_MODULE_0___default().readdirSync(audioDir).filter((file)=>file !== 'folders.json' && file !== 'metadata.json').map((filename)=>{\n                        const id = filename.split('-')[0]; // Get the ID part before the first hyphen\n                        const fileMetadata = metadata[id] || {};\n                        const stats = fs__WEBPACK_IMPORTED_MODULE_0___default().statSync(path__WEBPACK_IMPORTED_MODULE_1___default().join(audioDir, filename));\n                        return {\n                            id,\n                            name: fileMetadata.name || filename,\n                            url: `/audio/${filename}`,\n                            folderId: fileMetadata.folderId || null,\n                            size: stats.size,\n                            type: fileMetadata.type || 'audio/mpeg',\n                            createdAt: fileMetadata.createdAt || stats.birthtime\n                        };\n                    }).filter((file)=>{\n                        // If a folder ID is provided, only return files in that folder\n                        if (folderId) {\n                            const fileMetadata = metadata[file.id];\n                            return fileMetadata && fileMetadata.folderId === folderId;\n                        }\n                        // If no folder ID is provided, return files that are not in any folder\n                        return !metadata[file.id]?.folderId;\n                    });\n                    res.status(200).json({\n                        files\n                    });\n                }\n                break;\n            case 'POST':\n                // Create new folder\n                if (query.type === 'folders') {\n                    const { name } = req.body;\n                    if (!name) {\n                        return res.status(400).json({\n                            error: 'Le nom du dossier est requis'\n                        });\n                    }\n                    const folders = getFolders();\n                    const newFolder = {\n                        id: Date.now().toString(),\n                        name,\n                        createdAt: new Date().toISOString()\n                    };\n                    folders.push(newFolder);\n                    saveFolders(folders);\n                    res.status(201).json(newFolder);\n                } else {\n                    res.status(400).json({\n                        error: 'Opération invalide'\n                    });\n                }\n                break;\n            case 'PUT':\n                if (query.type === 'folders' && query.id) {\n                    // Rename folder\n                    const { name } = req.body;\n                    const folders = getFolders();\n                    const folderIndex = folders.findIndex((f)=>f.id === query.id);\n                    if (folderIndex === -1) {\n                        return res.status(404).json({\n                            error: 'Dossier non trouvé'\n                        });\n                    }\n                    folders[folderIndex].name = name;\n                    saveFolders(folders);\n                    res.status(200).json(folders[folderIndex]);\n                } else if (query.type === 'move' && query.id) {\n                    // Move file to different folder\n                    const { folderId } = req.body;\n                    const metadata = getMetadata();\n                    if (!metadata[query.id]) {\n                        metadata[query.id] = {};\n                    }\n                    metadata[query.id].folderId = folderId;\n                    saveMetadata(metadata);\n                    res.status(200).json({\n                        success: true\n                    });\n                } else if (query.type === 'rename' && query.id) {\n                    // Rename file\n                    const { name } = req.body;\n                    const metadata = getMetadata();\n                    if (!metadata[query.id]) {\n                        metadata[query.id] = {};\n                    }\n                    metadata[query.id].name = name;\n                    saveMetadata(metadata);\n                    res.status(200).json({\n                        success: true\n                    });\n                } else {\n                    res.status(400).json({\n                        error: 'Opération invalide'\n                    });\n                }\n                break;\n            case 'DELETE':\n                if (query.type === 'folders' && query.id) {\n                    // Delete folder\n                    const folders = getFolders();\n                    const newFolders = folders.filter((f)=>f.id !== query.id); // Fixed the condition here\n                    saveFolders(newFolders);\n                    // Update files in the folder to have no folder\n                    const metadata = getMetadata();\n                    Object.keys(metadata).forEach((fileId)=>{\n                        if (metadata[fileId].folderId === query.id) {\n                            metadata[fileId].folderId = null;\n                        }\n                    });\n                    saveMetadata(metadata);\n                    res.status(200).json({\n                        success: true\n                    });\n                } else if (query.id) {\n                    // Delete file\n                    const filename = findFileByIdWithExtension(query.id);\n                    if (!filename) {\n                        return res.status(404).json({\n                            error: 'Fichier non trouvé'\n                        });\n                    }\n                    const filePath = path__WEBPACK_IMPORTED_MODULE_1___default().join(audioDir, filename);\n                    try {\n                        // Delete the physical file\n                        fs__WEBPACK_IMPORTED_MODULE_0___default().unlinkSync(filePath);\n                        // Remove from metadata\n                        const metadata = getMetadata();\n                        delete metadata[query.id];\n                        saveMetadata(metadata);\n                        res.status(200).json({\n                            success: true\n                        });\n                    } catch (error) {\n                        console.error('Error deleting file:', error);\n                        res.status(500).json({\n                            error: 'Erreur lors de la suppression du fichier: ' + error.message\n                        });\n                    }\n                } else {\n                    res.status(400).json({\n                        error: 'Opération invalide'\n                    });\n                }\n                break;\n            default:\n                res.setHeader('Allow', [\n                    'GET',\n                    'POST',\n                    'PUT',\n                    'DELETE'\n                ]);\n                res.status(405).end(`Method ${method} Not Allowed`);\n        }\n    } catch (error) {\n        console.error('API Error:', error);\n        res.status(500).json({\n            error: 'Erreur interne du serveur: ' + error.message\n        });\n    }\n}\nconst config = {\n    api: {\n        bodyParser: true\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUksQ0FBQztZQUFFcEIsT0FBTyxnQ0FBZ0NBLE1BQU1vRCxPQUFPO1FBQUM7SUFDOUU7QUFDRjtBQUVPLE1BQU1HLFNBQVM7SUFDcEJDLEtBQUs7UUFDSEMsWUFBWTtJQUNkO0FBQ0YsRUFBRSIsInNvdXJjZXMiOlsiQzpcXGxhcmFnb25cXHd3d1xcU05DRi1HZXN0aW9uXFxwYWdlc1xcYXBpXFxhdWRpby1maWxlcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZnMgZnJvbSAnZnMnO1xyXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcclxuXHJcbi8vIERlZmluZSBwYXRoc1xyXG5jb25zdCBhdWRpb0RpciA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAncHVibGljJywgJ2F1ZGlvJyk7XHJcbmNvbnN0IGZvbGRlcnNGaWxlID0gcGF0aC5qb2luKGF1ZGlvRGlyLCAnZm9sZGVycy5qc29uJyk7XHJcbmNvbnN0IG1ldGFkYXRhRmlsZSA9IHBhdGguam9pbihhdWRpb0RpciwgJ21ldGFkYXRhLmpzb24nKTtcclxuXHJcbi8vIEVuc3VyZSBkaXJlY3RvcmllcyBhbmQgZmlsZXMgZXhpc3RcclxuaWYgKCFmcy5leGlzdHNTeW5jKGF1ZGlvRGlyKSkge1xyXG4gIGZzLm1rZGlyU3luYyhhdWRpb0RpciwgeyByZWN1cnNpdmU6IHRydWUgfSk7XHJcbn1cclxuXHJcbmlmICghZnMuZXhpc3RzU3luYyhmb2xkZXJzRmlsZSkpIHtcclxuICBmcy53cml0ZUZpbGVTeW5jKGZvbGRlcnNGaWxlLCBKU09OLnN0cmluZ2lmeSh7IGZvbGRlcnM6IFtdIH0pKTtcclxufVxyXG5cclxuaWYgKCFmcy5leGlzdHNTeW5jKG1ldGFkYXRhRmlsZSkpIHtcclxuICBmcy53cml0ZUZpbGVTeW5jKG1ldGFkYXRhRmlsZSwgSlNPTi5zdHJpbmdpZnkoe30pKTtcclxufVxyXG5cclxuLy8gSGVscGVyIGZ1bmN0aW9uc1xyXG5mdW5jdGlvbiBnZXRGb2xkZXJzKCkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBkYXRhID0gZnMucmVhZEZpbGVTeW5jKGZvbGRlcnNGaWxlLCAndXRmOCcpO1xyXG4gICAgcmV0dXJuIEpTT04ucGFyc2UoZGF0YSkuZm9sZGVycztcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVhZGluZyBmb2xkZXJzOicsIGVycm9yKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNhdmVGb2xkZXJzKGZvbGRlcnMpIHtcclxuICBmcy53cml0ZUZpbGVTeW5jKGZvbGRlcnNGaWxlLCBKU09OLnN0cmluZ2lmeSh7IGZvbGRlcnMgfSwgbnVsbCwgMikpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRNZXRhZGF0YSgpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgZGF0YSA9IGZzLnJlYWRGaWxlU3luYyhtZXRhZGF0YUZpbGUsICd1dGY4Jyk7XHJcbiAgICByZXR1cm4gSlNPTi5wYXJzZShkYXRhKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVhZGluZyBtZXRhZGF0YTonLCBlcnJvcik7XHJcbiAgICByZXR1cm4ge307XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBzYXZlTWV0YWRhdGEobWV0YWRhdGEpIHtcclxuICBmcy53cml0ZUZpbGVTeW5jKG1ldGFkYXRhRmlsZSwgSlNPTi5zdHJpbmdpZnkobWV0YWRhdGEsIG51bGwsIDIpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZmluZEZpbGVCeUlkV2l0aEV4dGVuc2lvbihmaWxlSWQpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgZmlsZXMgPSBmcy5yZWFkZGlyU3luYyhhdWRpb0Rpcik7XHJcbiAgICByZXR1cm4gZmlsZXMuZmluZChmaWxlID0+IFxyXG4gICAgICBmaWxlICE9PSAnZm9sZGVycy5qc29uJyAmJiBcclxuICAgICAgZmlsZSAhPT0gJ21ldGFkYXRhLmpzb24nICYmIFxyXG4gICAgICBmaWxlLnN0YXJ0c1dpdGgoZmlsZUlkKVxyXG4gICAgKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmluZGluZyBmaWxlOicsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xyXG4gIGNvbnN0IHsgbWV0aG9kLCBxdWVyeSB9ID0gcmVxO1xyXG5cclxuICB0cnkge1xyXG4gICAgc3dpdGNoIChtZXRob2QpIHtcclxuICAgICAgY2FzZSAnR0VUJzpcclxuICAgICAgICAvLyBMaXN0IGZpbGVzIG9yIGZvbGRlcnNcclxuICAgICAgICBpZiAocXVlcnkudHlwZSA9PT0gJ2ZvbGRlcnMnKSB7XHJcbiAgICAgICAgICBjb25zdCBmb2xkZXJzID0gZ2V0Rm9sZGVycygpO1xyXG4gICAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBmb2xkZXJzIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjb25zdCBmb2xkZXJJZCA9IHF1ZXJ5LmZvbGRlcklkO1xyXG4gICAgICAgICAgY29uc3QgbWV0YWRhdGEgPSBnZXRNZXRhZGF0YSgpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBHZXQgYWxsIGZpbGVzIGluIHRoZSBhdWRpbyBkaXJlY3RvcnlcclxuICAgICAgICAgIGNvbnN0IGZpbGVzID0gZnMucmVhZGRpclN5bmMoYXVkaW9EaXIpXHJcbiAgICAgICAgICAgIC5maWx0ZXIoZmlsZSA9PiBmaWxlICE9PSAnZm9sZGVycy5qc29uJyAmJiBmaWxlICE9PSAnbWV0YWRhdGEuanNvbicpXHJcbiAgICAgICAgICAgIC5tYXAoZmlsZW5hbWUgPT4ge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGlkID0gZmlsZW5hbWUuc3BsaXQoJy0nKVswXTsgLy8gR2V0IHRoZSBJRCBwYXJ0IGJlZm9yZSB0aGUgZmlyc3QgaHlwaGVuXHJcbiAgICAgICAgICAgICAgY29uc3QgZmlsZU1ldGFkYXRhID0gbWV0YWRhdGFbaWRdIHx8IHt9O1xyXG4gICAgICAgICAgICAgIGNvbnN0IHN0YXRzID0gZnMuc3RhdFN5bmMocGF0aC5qb2luKGF1ZGlvRGlyLCBmaWxlbmFtZSkpO1xyXG4gICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBpZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IGZpbGVNZXRhZGF0YS5uYW1lIHx8IGZpbGVuYW1lLFxyXG4gICAgICAgICAgICAgICAgdXJsOiBgL2F1ZGlvLyR7ZmlsZW5hbWV9YCxcclxuICAgICAgICAgICAgICAgIGZvbGRlcklkOiBmaWxlTWV0YWRhdGEuZm9sZGVySWQgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgIHNpemU6IHN0YXRzLnNpemUsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiBmaWxlTWV0YWRhdGEudHlwZSB8fCAnYXVkaW8vbXBlZycsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGZpbGVNZXRhZGF0YS5jcmVhdGVkQXQgfHwgc3RhdHMuYmlydGh0aW1lXHJcbiAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmZpbHRlcihmaWxlID0+IHtcclxuICAgICAgICAgICAgICAvLyBJZiBhIGZvbGRlciBJRCBpcyBwcm92aWRlZCwgb25seSByZXR1cm4gZmlsZXMgaW4gdGhhdCBmb2xkZXJcclxuICAgICAgICAgICAgICBpZiAoZm9sZGVySWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVNZXRhZGF0YSA9IG1ldGFkYXRhW2ZpbGUuaWRdO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpbGVNZXRhZGF0YSAmJiBmaWxlTWV0YWRhdGEuZm9sZGVySWQgPT09IGZvbGRlcklkO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAvLyBJZiBubyBmb2xkZXIgSUQgaXMgcHJvdmlkZWQsIHJldHVybiBmaWxlcyB0aGF0IGFyZSBub3QgaW4gYW55IGZvbGRlclxyXG4gICAgICAgICAgICAgIHJldHVybiAhbWV0YWRhdGFbZmlsZS5pZF0/LmZvbGRlcklkO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IGZpbGVzIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgJ1BPU1QnOlxyXG4gICAgICAgIC8vIENyZWF0ZSBuZXcgZm9sZGVyXHJcbiAgICAgICAgaWYgKHF1ZXJ5LnR5cGUgPT09ICdmb2xkZXJzJykge1xyXG4gICAgICAgICAgY29uc3QgeyBuYW1lIH0gPSByZXEuYm9keTtcclxuICAgICAgICAgIGlmICghbmFtZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ0xlIG5vbSBkdSBkb3NzaWVyIGVzdCByZXF1aXMnIH0pO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGNvbnN0IGZvbGRlcnMgPSBnZXRGb2xkZXJzKCk7XHJcbiAgICAgICAgICBjb25zdCBuZXdGb2xkZXIgPSB7XHJcbiAgICAgICAgICAgIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksXHJcbiAgICAgICAgICAgIG5hbWUsXHJcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgIGZvbGRlcnMucHVzaChuZXdGb2xkZXIpO1xyXG4gICAgICAgICAgc2F2ZUZvbGRlcnMoZm9sZGVycyk7XHJcbiAgICAgICAgICByZXMuc3RhdHVzKDIwMSkuanNvbihuZXdGb2xkZXIpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnT3DDqXJhdGlvbiBpbnZhbGlkZScgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSAnUFVUJzpcclxuICAgICAgICBpZiAocXVlcnkudHlwZSA9PT0gJ2ZvbGRlcnMnICYmIHF1ZXJ5LmlkKSB7XHJcbiAgICAgICAgICAvLyBSZW5hbWUgZm9sZGVyXHJcbiAgICAgICAgICBjb25zdCB7IG5hbWUgfSA9IHJlcS5ib2R5O1xyXG4gICAgICAgICAgY29uc3QgZm9sZGVycyA9IGdldEZvbGRlcnMoKTtcclxuICAgICAgICAgIGNvbnN0IGZvbGRlckluZGV4ID0gZm9sZGVycy5maW5kSW5kZXgoZiA9PiBmLmlkID09PSBxdWVyeS5pZCk7XHJcblxyXG4gICAgICAgICAgaWYgKGZvbGRlckluZGV4ID09PSAtMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ0Rvc3NpZXIgbm9uIHRyb3V2w6knIH0pO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGZvbGRlcnNbZm9sZGVySW5kZXhdLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgICAgc2F2ZUZvbGRlcnMoZm9sZGVycyk7XHJcbiAgICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihmb2xkZXJzW2ZvbGRlckluZGV4XSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChxdWVyeS50eXBlID09PSAnbW92ZScgJiYgcXVlcnkuaWQpIHtcclxuICAgICAgICAgIC8vIE1vdmUgZmlsZSB0byBkaWZmZXJlbnQgZm9sZGVyXHJcbiAgICAgICAgICBjb25zdCB7IGZvbGRlcklkIH0gPSByZXEuYm9keTtcclxuICAgICAgICAgIGNvbnN0IG1ldGFkYXRhID0gZ2V0TWV0YWRhdGEoKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgaWYgKCFtZXRhZGF0YVtxdWVyeS5pZF0pIHtcclxuICAgICAgICAgICAgbWV0YWRhdGFbcXVlcnkuaWRdID0ge307XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgbWV0YWRhdGFbcXVlcnkuaWRdLmZvbGRlcklkID0gZm9sZGVySWQ7XHJcbiAgICAgICAgICBzYXZlTWV0YWRhdGEobWV0YWRhdGEpO1xyXG4gICAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocXVlcnkudHlwZSA9PT0gJ3JlbmFtZScgJiYgcXVlcnkuaWQpIHtcclxuICAgICAgICAgIC8vIFJlbmFtZSBmaWxlXHJcbiAgICAgICAgICBjb25zdCB7IG5hbWUgfSA9IHJlcS5ib2R5O1xyXG4gICAgICAgICAgY29uc3QgbWV0YWRhdGEgPSBnZXRNZXRhZGF0YSgpO1xyXG5cclxuICAgICAgICAgIGlmICghbWV0YWRhdGFbcXVlcnkuaWRdKSB7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhW3F1ZXJ5LmlkXSA9IHt9O1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIG1ldGFkYXRhW3F1ZXJ5LmlkXS5uYW1lID0gbmFtZTtcclxuICAgICAgICAgIHNhdmVNZXRhZGF0YShtZXRhZGF0YSk7XHJcbiAgICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdPcMOpcmF0aW9uIGludmFsaWRlJyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlICdERUxFVEUnOlxyXG4gICAgICAgIGlmIChxdWVyeS50eXBlID09PSAnZm9sZGVycycgJiYgcXVlcnkuaWQpIHtcclxuICAgICAgICAgIC8vIERlbGV0ZSBmb2xkZXJcclxuICAgICAgICAgIGNvbnN0IGZvbGRlcnMgPSBnZXRGb2xkZXJzKCk7XHJcbiAgICAgICAgICBjb25zdCBuZXdGb2xkZXJzID0gZm9sZGVycy5maWx0ZXIoZiA9PiBmLmlkICE9PSBxdWVyeS5pZCk7IC8vIEZpeGVkIHRoZSBjb25kaXRpb24gaGVyZVxyXG4gICAgICAgICAgc2F2ZUZvbGRlcnMobmV3Rm9sZGVycyk7XHJcblxyXG4gICAgICAgICAgLy8gVXBkYXRlIGZpbGVzIGluIHRoZSBmb2xkZXIgdG8gaGF2ZSBubyBmb2xkZXJcclxuICAgICAgICAgIGNvbnN0IG1ldGFkYXRhID0gZ2V0TWV0YWRhdGEoKTtcclxuICAgICAgICAgIE9iamVjdC5rZXlzKG1ldGFkYXRhKS5mb3JFYWNoKGZpbGVJZCA9PiB7XHJcbiAgICAgICAgICAgIGlmIChtZXRhZGF0YVtmaWxlSWRdLmZvbGRlcklkID09PSBxdWVyeS5pZCkge1xyXG4gICAgICAgICAgICAgIG1ldGFkYXRhW2ZpbGVJZF0uZm9sZGVySWQgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIHNhdmVNZXRhZGF0YShtZXRhZGF0YSk7XHJcblxyXG4gICAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocXVlcnkuaWQpIHtcclxuICAgICAgICAgIC8vIERlbGV0ZSBmaWxlXHJcbiAgICAgICAgICBjb25zdCBmaWxlbmFtZSA9IGZpbmRGaWxlQnlJZFdpdGhFeHRlbnNpb24ocXVlcnkuaWQpO1xyXG5cclxuICAgICAgICAgIGlmICghZmlsZW5hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdGaWNoaWVyIG5vbiB0cm91dsOpJyB9KTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IHBhdGguam9pbihhdWRpb0RpciwgZmlsZW5hbWUpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyBEZWxldGUgdGhlIHBoeXNpY2FsIGZpbGVcclxuICAgICAgICAgICAgZnMudW5saW5rU3luYyhmaWxlUGF0aCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBSZW1vdmUgZnJvbSBtZXRhZGF0YVxyXG4gICAgICAgICAgICBjb25zdCBtZXRhZGF0YSA9IGdldE1ldGFkYXRhKCk7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBtZXRhZGF0YVtxdWVyeS5pZF07XHJcbiAgICAgICAgICAgIHNhdmVNZXRhZGF0YShtZXRhZGF0YSk7XHJcblxyXG4gICAgICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSk7XHJcbiAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBmaWxlOicsIGVycm9yKTtcclxuICAgICAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0VycmV1ciBsb3JzIGRlIGxhIHN1cHByZXNzaW9uIGR1IGZpY2hpZXI6ICcgKyBlcnJvci5tZXNzYWdlIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnT3DDqXJhdGlvbiBpbnZhbGlkZScgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXMuc2V0SGVhZGVyKCdBbGxvdycsIFsnR0VUJywgJ1BPU1QnLCAnUFVUJywgJ0RFTEVURSddKTtcclxuICAgICAgICByZXMuc3RhdHVzKDQwNSkuZW5kKGBNZXRob2QgJHttZXRob2R9IE5vdCBBbGxvd2VkYCk7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0FQSSBFcnJvcjonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRXJyZXVyIGludGVybmUgZHUgc2VydmV1cjogJyArIGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIGFwaToge1xyXG4gICAgYm9keVBhcnNlcjogdHJ1ZSxcclxuICB9LFxyXG59O1xyXG4iXSwibmFtZXMiOlsiZnMiLCJwYXRoIiwiYXVkaW9EaXIiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsImZvbGRlcnNGaWxlIiwibWV0YWRhdGFGaWxlIiwiZXhpc3RzU3luYyIsIm1rZGlyU3luYyIsInJlY3Vyc2l2ZSIsIndyaXRlRmlsZVN5bmMiLCJKU09OIiwic3RyaW5naWZ5IiwiZm9sZGVycyIsImdldEZvbGRlcnMiLCJkYXRhIiwicmVhZEZpbGVTeW5jIiwicGFyc2UiLCJlcnJvciIsImNvbnNvbGUiLCJzYXZlRm9sZGVycyIsImdldE1ldGFkYXRhIiwic2F2ZU1ldGFkYXRhIiwibWV0YWRhdGEiLCJmaW5kRmlsZUJ5SWRXaXRoRXh0ZW5zaW9uIiwiZmlsZUlkIiwiZmlsZXMiLCJyZWFkZGlyU3luYyIsImZpbmQiLCJmaWxlIiwic3RhcnRzV2l0aCIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJxdWVyeSIsInR5cGUiLCJzdGF0dXMiLCJqc29uIiwiZm9sZGVySWQiLCJmaWx0ZXIiLCJtYXAiLCJmaWxlbmFtZSIsImlkIiwic3BsaXQiLCJmaWxlTWV0YWRhdGEiLCJzdGF0cyIsInN0YXRTeW5jIiwibmFtZSIsInVybCIsInNpemUiLCJjcmVhdGVkQXQiLCJiaXJ0aHRpbWUiLCJib2R5IiwibmV3Rm9sZGVyIiwiRGF0ZSIsIm5vdyIsInRvU3RyaW5nIiwidG9JU09TdHJpbmciLCJwdXNoIiwiZm9sZGVySW5kZXgiLCJmaW5kSW5kZXgiLCJmIiwic3VjY2VzcyIsIm5ld0ZvbGRlcnMiLCJPYmplY3QiLCJrZXlzIiwiZm9yRWFjaCIsImZpbGVQYXRoIiwidW5saW5rU3luYyIsIm1lc3NhZ2UiLCJzZXRIZWFkZXIiLCJlbmQiLCJjb25maWciLCJhcGkiLCJib2R5UGFyc2VyIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./pages/api/audio-files.js\n");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Faudio-files&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Caudio-files.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();